{"ast":null,"code":"import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";import _inherits from\"@babel/runtime/helpers/inherits\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";import*as WebBrowser from'expo-web-browser';import React from'react';import Image from\"react-native-web/dist/exports/Image\";import ScrollView from\"react-native-web/dist/exports/ScrollView\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import Text from\"react-native-web/dist/exports/Text\";import ActivityIndicator from\"react-native-web/dist/exports/ActivityIndicator\";import View from\"react-native-web/dist/exports/View\";import Alert from\"react-native-web/dist/exports/Alert\";import RefreshControl from\"react-native-web/dist/exports/RefreshControl\";import TouchableOpacity from\"react-native-web/dist/exports/TouchableOpacity\";import TouchableNativeFeedback from\"react-native-web/dist/exports/TouchableNativeFeedback\";import TouchableWithoutFeedback from\"react-native-web/dist/exports/TouchableWithoutFeedback\";import Card from\"../components/Card\";import Constants from'expo-constants';import FirebaseHelper from\"../helper/FireBaseHelper\";function imageLoader(table){var imageNameList,imageList;return _regeneratorRuntime.async(function imageLoader$(_context){while(1){switch(_context.prev=_context.next){case 0:imageNameList=[];imageList=[];_context.next=4;return _regeneratorRuntime.awrap(getImageName(table));case 4:imageNameList=_context.sent;if(!(imageNameList.length>0)){_context.next=11;break;}_context.next=8;return _regeneratorRuntime.awrap(getImage(imageNameList));case 8:imageList=_context.sent;_context.next=12;break;case 11:Alert.alert(\"ไม่พบรูปภาพ\");case 12:return _context.abrupt(\"return\",imageList);case 13:case\"end\":return _context.stop();}}});}function getImageName(table){var result;return _regeneratorRuntime.async(function getImageName$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:result=[];_context2.next=3;return _regeneratorRuntime.awrap(FirebaseHelper.queryData(table).then(function(data){data.forEach(function(item,index){result.push(item);});}).then(function(){return result;}));case 3:return _context2.abrupt(\"return\",_context2.sent);case 4:case\"end\":return _context2.stop();}}});}function getImage(imageNameList){var imageStoreList,object;return _regeneratorRuntime.async(function getImage$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:imageStoreList=[];object=[];_context3.next=4;return _regeneratorRuntime.awrap(imageNameList.forEach(function(item,index){FirebaseHelper.queryFileStorage(\"/itemList/\"+item.pic).then(function(image){if(image!=undefined){object={data:imageNameList[index],imageUrl:image};imageStoreList.push(object);}}).then(function(){return imageStoreList;});}));case 4:return _context3.abrupt(\"return\",imageStoreList);case 5:case\"end\":return _context3.stop();}}});}function CardList(props){return props.itemList.map(function(keyItem,index){return React.createElement(TouchableOpacity,{key:index,onPress:function onPress(){return props.navProp.navigation.navigate(\"Booking\",{productCode:keyItem.data.product_code});},activeOpacity:1},React.createElement(CardItem,{object:keyItem}));});}function CardItem(props){var param=props.object;return React.createElement(Card,null,React.createElement(View,{style:{flexDirection:'row'},key:props.index},React.createElement(View,{style:{flex:0.3,margin:3,backgroundColor:'#ffffff'}},React.createElement(Image,{source:{uri:param.imageUrl},style:{width:'100%',height:'100%'},resizeMode:\"contain\"})),React.createElement(View,{style:{flex:1,flexDirection:'column',padding:5}},React.createElement(View,null,React.createElement(Text,{style:{fontFamily:'kanit-bold',fontSize:15}},param.data.product_name)),React.createElement(View,{style:{backgroundColor:'#ffffff',borderRadius:10,padding:5}},React.createElement(Text,null,\"Point : \",param.data.all_point),React.createElement(Text,null,\"Stamp : \",param.data.m_stamp),React.createElement(Text,null,\"Cash : \",param.data.cash)))));}var ItemScreen=function(_React$Component){_inherits(ItemScreen,_React$Component);function ItemScreen(props){var _this;_classCallCheck(this,ItemScreen);_this=_possibleConstructorReturn(this,_getPrototypeOf(ItemScreen).call(this,props));_this.state={showLoader:true,refreshing:false,imageList:[],imageTest:\"\"};return _this;}_createClass(ItemScreen,[{key:\"componentWillMount\",value:function componentWillMount(){return _regeneratorRuntime.async(function componentWillMount$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return _regeneratorRuntime.awrap(this.fetchData());case 2:case\"end\":return _context4.stop();}}},null,this);}},{key:\"fetchData\",value:function fetchData(){var _this2=this;var imageStoreList;return _regeneratorRuntime.async(function fetchData$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:imageStoreList=[];_context5.next=3;return _regeneratorRuntime.awrap(imageLoader(\"tb_product_master\"));case 3:imageStoreList=_context5.sent;setTimeout(function(){if(imageStoreList.length>0){_this2.setState({showLoader:false,imageList:imageStoreList});}},1000);case 5:case\"end\":return _context5.stop();}}});}},{key:\"_onRefresh\",value:function _onRefresh(){var _this3=this;this.setState({showLoader:false,refreshing:true});this.fetchData().then(function(){_this3.setState({refreshing:false});});}},{key:\"render\",value:function render(){if(this.state.showLoader){return React.createElement(View,{style:styles.spinner},React.createElement(ActivityIndicator,{size:\"large\",color:\"#0000ff\"}));}else{return React.createElement(View,{style:styles.container},React.createElement(ScrollView,{showsVerticalScrollIndicator:false,refreshControl:React.createElement(RefreshControl,{refreshing:this.state.refreshing,onRefresh:this._onRefresh.bind(this),colors:['blue']})},React.createElement(CardList,{itemList:this.state.imageList,navProp:this.props})));}}}]);return ItemScreen;}(React.Component);export{ItemScreen as default};ItemScreen.navigationOptions={title:'รายการสินค้า'};var styles=StyleSheet.create({container:{flex:1,paddingTop:Constants.statusBarHeight,paddingBottom:10,paddingHorizontal:10,flexDirection:'column'},spinner:{flex:1,marginTop:Constants.statusBarHeight,justifyContent:'center'}});","map":{"version":3,"sources":["D:/GitProject/PremiumReserve/screens/ItemScreen.js"],"names":["WebBrowser","React","Card","Constants","FirebaseHelper","imageLoader","table","imageNameList","imageList","getImageName","length","getImage","Alert","alert","result","queryData","then","data","forEach","item","index","push","imageStoreList","object","queryFileStorage","pic","image","undefined","imageUrl","CardList","props","itemList","map","keyItem","navProp","navigation","navigate","productCode","product_code","CardItem","param","flexDirection","flex","margin","backgroundColor","uri","width","height","padding","fontFamily","fontSize","product_name","borderRadius","all_point","m_stamp","cash","ItemScreen","state","showLoader","refreshing","imageTest","fetchData","setTimeout","setState","styles","spinner","container","_onRefresh","bind","Component","navigationOptions","title","StyleSheet","create","paddingTop","statusBarHeight","paddingBottom","paddingHorizontal","marginTop","justifyContent"],"mappings":"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","sourcesContent":["import * as WebBrowser from 'expo-web-browser';\r\nimport React from 'react';\r\n// import * as firebase from 'firebase';\r\nimport {\r\n  Image,\r\n  ScrollView,\r\n  StyleSheet,\r\n  Text,\r\n  ActivityIndicator,\r\n  View,\r\n  Alert,\r\n  RefreshControl,\r\n  TouchableOpacity,\r\n  TouchableNativeFeedback,\r\n  TouchableWithoutFeedback \r\n} from 'react-native';\r\n\r\nimport Card from '../components/Card'\r\nimport Constants from 'expo-constants'\r\nimport FirebaseHelper from '../helper/FireBaseHelper'\r\n// import DeviceInfo from 'react-native-device-info';\r\n// import {getUniqueId} from 'react-native-device-info'\r\n\r\nasync function imageLoader(table){\r\n  var imageNameList = [];\r\n  var imageList = [];\r\n  \r\n  imageNameList = await getImageName(table);\r\n\r\n  if( imageNameList.length > 0 ){\r\n\r\n    imageList = await getImage(imageNameList);\r\n\r\n  }else{\r\n    Alert.alert(\"ไม่พบรูปภาพ\");\r\n  }\r\n\r\n  return imageList;\r\n\r\n}\r\n\r\nasync function getImageName(table){\r\n\r\n  const result = [];\r\n\r\n  return await FirebaseHelper.queryData(table).then((data) => {\r\n    data.forEach(function(item, index){\r\n      result.push(item);\r\n    })\r\n  }).then(()=>{\r\n    return result;\r\n  })\r\n\r\n}\r\n\r\nasync function getImage(imageNameList){\r\n\r\n  var imageStoreList = [];\r\n  var object = [];\r\n\r\n  await imageNameList.forEach(function(item, index){\r\n    FirebaseHelper.queryFileStorage(\"/itemList/\"+item.pic).then((image) => {\r\n        if( image != undefined ){\r\n          object = {\r\n            data: imageNameList[index],\r\n            imageUrl: image\r\n          }\r\n          imageStoreList.push(object);\r\n        }\r\n    }).then(()=>{\r\n      return imageStoreList;\r\n    })\r\n  })\r\n\r\n  return imageStoreList;\r\n\r\n}\r\n\r\nfunction CardList(props){\r\n\r\n  return props.itemList.map((keyItem, index)=>{\r\n\r\n    return (\r\n      <TouchableOpacity  key={index} onPress={()=> props.navProp.navigation.navigate(\"Booking\",{\r\n        productCode: keyItem.data.product_code\r\n      })} activeOpacity={1}>\r\n        <CardItem object={keyItem}/>\r\n      </TouchableOpacity >\r\n    )\r\n\r\n  })\r\n\r\n}\r\n\r\nfunction CardItem(props){\r\n\r\n  var param = props.object;\r\n\r\n  return (\r\n      <Card>\r\n        <View style={{flexDirection: 'row'}} key={props.index} >\r\n          <View style={{flex: 0.3, margin: 3, backgroundColor: '#ffffff'}}>\r\n            <Image \r\n              source={{uri : param.imageUrl}} \r\n              style={\r\n                {\r\n                  width: '100%',\r\n                  height: '100%',\r\n                }\r\n              }\r\n              resizeMode='contain'\r\n            />\r\n          </View>\r\n          <View style={{flex: 1, flexDirection: 'column', padding: 5}}>\r\n              <View>\r\n                <Text style={{fontFamily: 'kanit-bold', fontSize: 15}}>\r\n                  {param.data.product_name}\r\n                </Text>\r\n              </View>\r\n              <View style={{backgroundColor: '#ffffff', borderRadius: 10, padding: 5}}>\r\n                <Text>\r\n                  Point : {param.data.all_point}\r\n                </Text>\r\n                <Text>\r\n                  Stamp : {param.data.m_stamp}\r\n                </Text>\r\n                <Text>\r\n                  Cash : {param.data.cash}\r\n                </Text>\r\n              </View>\r\n          </View>\r\n        </View>\r\n      </Card>\r\n  )\r\n\r\n}\r\n\r\nexport default class ItemScreen extends React.Component {\r\n\r\n  constructor (props) {\r\n    super(props);\r\n    this.state = {\r\n      showLoader: true,\r\n      refreshing: false,\r\n      imageList: [],\r\n      imageTest: \"\"\r\n    };\r\n\r\n  }\r\n\r\n  async componentWillMount() {\r\n    await this.fetchData();\r\n  }\r\n\r\n  async fetchData() {\r\n    var imageStoreList = [];\r\n\r\n    imageStoreList = await imageLoader(\"tb_product_master\");\r\n\r\n    setTimeout(() => {\r\n\r\n      if( imageStoreList.length > 0 ){\r\n\r\n        this.setState({\r\n          showLoader: false,\r\n          imageList: imageStoreList\r\n        })\r\n    \r\n      }\r\n\r\n    }, 1000);\r\n  }\r\n\r\n  _onRefresh() {\r\n    this.setState({\r\n      showLoader: false,\r\n      refreshing: true\r\n    });\r\n    this.fetchData().then(() => {\r\n      this.setState({refreshing: false});\r\n    });\r\n  }\r\n\r\n  render(){\r\n\r\n    if( this.state.showLoader ){\r\n      return <View style={styles.spinner}><ActivityIndicator size=\"large\" color=\"#0000ff\" /></View>\r\n    }else{\r\n      return (\r\n        <View style={styles.container}>\r\n          <ScrollView\r\n              showsVerticalScrollIndicator={false}\r\n              refreshControl={\r\n                <RefreshControl refreshing={this.state.refreshing} onRefresh={this._onRefresh.bind(this)} colors={['blue']} />\r\n              }\r\n          >\r\n            <CardList itemList={this.state.imageList} navProp={this.props}/>\r\n          </ScrollView>\r\n        </View>\r\n      );\r\n    }\r\n\r\n  }\r\n\r\n}\r\n\r\nItemScreen.navigationOptions = {\r\n  title: 'รายการสินค้า',\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    paddingTop: Constants.statusBarHeight,\r\n    paddingBottom: 10,\r\n    paddingHorizontal: 10,\r\n    flexDirection: 'column',\r\n  },\r\n  spinner: {\r\n    flex: 1,\r\n    marginTop: Constants.statusBarHeight,\r\n    justifyContent: 'center'\r\n  }\r\n  // imagePanel: {\r\n  //   flex: 1,\r\n  //   justifyContent: 'center',\r\n  //   alignItems: 'center',\r\n  // },\r\n  // imageGrid: {\r\n  //   width: '80%',\r\n  //   height: '80%',\r\n  //   borderColor: '#000000',\r\n  //   borderWidth: 1,\r\n  //   justifyContent: 'center',\r\n  //   alignItems: 'center',\r\n  //   borderRadius: 10\r\n  // },\r\n});\r\n"]},"metadata":{},"sourceType":"module"}